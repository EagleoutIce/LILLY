\lstdefinelanguage{lProlog}{
    language=prolog,
    alsoletter={-,|,~,{,},_,.,>,<,=,:,\*,',?},
    comment=[l]{\%},
    keywordsprefix={\$},
    % morecomment=[s]{\{-}{-\}},
    escapeinside={!!}{!!},
    morekeywords = {:-},
    morekeywords = [2]{->,=>,<-,>=,=:=, =\=,=<,<,>},
    morekeywords = [3]{True,False},
    morekeywords = [4]{::=},
    morekeywords = [5]{?-,?},
}

\lstnewenvironment{prolog}[1][]
  {\lstset{language=lProlog,#1}}
{}

\DeclareRobustCommand{\cprolog}[1]{\LILLYxwriteLst[language=lProlog]{#1}}