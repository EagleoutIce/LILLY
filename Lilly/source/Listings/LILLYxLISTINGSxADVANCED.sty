\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{LILLYxLISTINGSxADVANCED}[2019/08/23 Stellt eine Optik-Erweiterung fuer LILLYxLISTINGS zur Verfuegung]

\RequirePackage{LILLYxLISTINGS}
\RequirePackage{LILLYxCONTROLLERxBOX}

\tcbuselibrary{listingsutf8}

\lstdefinestyle{LSTADVANCED}{
    backgroundcolor={},
    rulecolor={},
    numberstyle=\color{gray}\LILLYxLISTINGSxNUMxFONTSIZE\sffamily,
    xleftmargin=12pt,
    xrightmargin=3pt,
    frame=l,
    numbers=left,
    numbersep=12pt,
    framexleftmargin=3pt,
    rulecolor=\color{Charcoal},
    %frameround=tttt, %% mag backgroundcolor nicht
    framerule=0.5pt,
}

\tcbset{
  lstpresenterstyle/.style={%
    colback=MudWhite!5,
    boxrule=1pt,
    enhanced jigsaw,
    listing only,
    breakable=true,
    opacityback=0.9,
    arc is angular=5mm,
    fuzzy halo=0.1mm with MudWhite,
    top=0.11mm,
    bottom=0.11mm,
    colframe=Charcoal,
  }
}


\DeclareTotalTCBox{\LILLYxLSTINLINExADVANCED}{ s m m }
{verbatim,lstpresenterstyle,left=0.25mm,right=0.25mm}
{\lstinline[language=#2]^#3^}


\newtcblisting{presentlst}[2][]{%
  lstpresenterstyle,
  listing options={%
    language=#2,
    style=LSTADVANCED},
  #1%
}
{}

% \def\ConstructEnv#1#2{
% \global\DeclareTCBListing{#1}{ O{} }{%
%         lstpresenterstyle,
%         listing options={%
%           language=#2,
%           style=LSTADVANCED},
%         ##1%
%       }
% }

\getRegisteredLanguages%
\typeout{Start advanced Language Registration}
\foreach \clang/\llang in \lillyxlist {%
  \ifthenelse{\equal{\clang}{}}{}{
    \ifthenelse{\equal{\llang}{}}{}{
        \edef\fexpclang{s\clang}
        \typeout{New Presenter for: \clang\space (\llang) with name: p\clang\space and for long: \fexpclang}
        %\ConstructEnv{\fexpclang}{\llang}
      \expandafter\xdef\csname p\clang\endcsname##1{\noexpand\protect\noexpand\LILLYxLSTINLINExADVANCED{\llang}{##1}}
      \expandafter\robustify\csname p\clang\endcsname
  }}
}

\newtcblisting{sjava}[1][]{%
  lstpresenterstyle,
  listing options={%
    language=lJava,
    style=LSTADVANCED},
  #1%
}
{}

\newtcblisting{slatex}[1][]{%
  lstpresenterstyle,
  listing options={%
    language=lLatex,
    style=LSTADVANCED},
  #1%
}
{}

\newtcblisting{scpp}[1][]{%
  lstpresenterstyle,
  listing options={%
    language=lCpp,
    style=LSTADVANCED},
  #1%
}
{}

\endinput